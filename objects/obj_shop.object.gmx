<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.pauseBuffer = buffer_create(1024,buffer_grow,1);
buffer_seek(global.pauseBuffer,buffer_seek_start,0);
game_save_buffer(global.pauseBuffer);

surface = surface_create(view_wview[0],view_hview[0]);
surface_set_target(surface);
with(all) {
    event_perform(ev_draw,0);
}
surface_reset_target();
instance_deactivate_all(true);
instance_activate_object(obj_control);
obj_control.visible = false;

storeFont = font_add_sprite(spr_gui_font,ord("!"),true,0);

for(var i = 0; i &lt; 10; i ++) {
    items[i,0] = -1; //Item type
    items[i,1] = 0; //Item Price
    items[i,2] = 0; //Item Quantity
    items[i,3] = ""; //Item description
    items[i,4] = null; //Item stat if its equipment
}
items[0,0] = 0;
items[0,1] = 150; //Item Price
items[0,2] = 50; //Item Quantity

items[1,0] = 1;
items[1,1] = 50; //Item Price
items[1,2] = 50; //Item Quantity

items[2,0] = 2; //weapon
items[2,1] = 5; //Item Price
items[2,2] = 1; //Item Quantity
items[2,4] = createEquipment(equipKind.weapon,"Excalibur",3000,0,0,0,0,0,3,3,50,5,1,0);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var wv, hv, xv, yv;
wv = view_wport[0];
hv = view_hport[0];
xv = view_xview[0];
yv = view_yview[0];

draw_set_alpha(0.8);
draw_rectangle(0,0,wv,hv,false);
draw_set_alpha(1);
var xRatio = view_wport[0]/view_wview[0];
var yRatio = view_hport[0]/view_hview[0];
draw_set_font(storeFont);
draw_set_valign(fa_top);
draw_set_halign(fa_left);
draw_text_transformed_colour(32,32,"Shop",4,4,0,white,white,white,white,1);
for(var i = 0; i &lt; 10; i++) {
    var xx = 32+(i div 5)*512;
    var yy = 156+(i mod 5)*80;
    var image = 0;
    if (items[i,2] &gt; 0) {
        draw_sprite(spr_potions,items[i,0],xx,yy);
        draw_set_valign(fa_top);
        draw_text_colour(xx+70,yy+32,items[i,3],white,white,white,white,1);
        draw_set_valign(fa_bottom);
        draw_set_halign(fa_left);
        draw_sprite_ext(spr_drop_item,0,xx+60,yy+16,2,2,0,white,1);
        draw_text_colour(xx+70,yy+64,string(items[i,1])+"#"+string(items[i,2])+" left",white,white,white,white,1); // Price
        if(popup_mouse_message((xx+320)/xRatio,yy/yRatio,(xx+448)/xRatio,(yy+64)/yRatio,false)) {
            image = 1;
            if(mouse_check_button_pressed(mb_left)) {
                image = 2;
                if (global.gold &gt;= items[i,1]) {
                    if(items[i,2] &gt; 0) {
                        items[i,2]--;
                        global.gold -= items[i,1];
                        switch(items[i,0]) {
                            case 0: //HP potion
                                global.HPPotion ++;
                                break;
                            case 1: //SP potion
                                global.SPPotion ++;
                                break;
                            case 2: //Equipment
                                if (is_array(items[i,4])) {
                                    var purchased = items[i,4];
                                    var equipSlot = purchased[0];
                                    var resell;
                                    for (var j = 0; j &lt; array_length_2d(global.equipment,equipSlot); j++) {
                                        resell[j+1] = global.equipment[equipSlot,j];
                                    }
                                    resell[0] = equipSlot;
                                    items[i,4] = resell;
                                    items[i,2] = resell[13];
                                    for (var j = 0; j &lt; array_length_2d(global.equipment,equipSlot); j++) {
                                        global.equipment[equipSlot,j] = purchased[j+1];
                                    }
                                    items[i,2]++;
                                }
                                break;
                        }
                    }
                }
            }
        }
        else {
            image = 0;
        }
        draw_sprite(spr_buy_button,image,xx+320,yy);
    }
}
if(keyboard_check_pressed(vk_escape)) {
    instance_activate_all();
    obj_control.visible = true;
    instance_destroy();
}
draw_sprite_ext(spr_drop_item,0,64,hv*0.75,3,3,0,white,1);
draw_set_valign(fa_center);
draw_set_halign(fa_left);
draw_text_transformed_colour(96,hv*0.75,global.gold,2,2,0,white,white,white,white,1);
draw_set_valign(fa_bottom);
draw_set_halign(fa_middle);
draw_text_colour(wv/2,hv,"Press &lt;ESC&gt; to leave",white,white,white,white,1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
